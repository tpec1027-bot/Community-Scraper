# Community-Scraper

這是一個專門處理「i智慧」系統產生之公有雲 PDF 謄本，能自動批次下載並極速精準擷取「地址」與「所有權人」資料的爬蟲工具。

## 💡 為什麼棄用 OCR 改用 PyMuPDF？

處理 PDF 的核心套件是 Python 的 **PyMuPDF**（在程式碼中稱為 `fitz`）。

1. **100% 精準度**：我們發現「i智慧」系統產生的公有雲 PDF 謄本，其實並不是像掃描機掃出來的「圖片」，它是數位產生的文件，所以底層直接包含了可以被游標反白選取的純文字。OCR（看圖認字）容易因為字體、解析度而出錯，但直接讀底層純文字是 100% 正確的！
2. **免除系統安裝綁定**：如果使用 Tesseract OCR 等工具，您的 Windows 電腦必須安裝外部軟體並設定環境變數，會增加部署的難度。PyMuPDF 只需要 `pip install` 就可以在任何電腦上立刻運行。
3. **無敵快**：OCR 分析圖片需要花費大量 CPU 運算時間，而 PyMuPDF 只是把文字檔「抽出來」，速度快了幾十倍，完全配合我們的「多執行緒極速下載計畫」。

### 🔍 提取的邏輯是什麼？
在抽出整頁的純文字後，我們運用了 **正則表達式 (Regular Expression)** 去精準定位：
> **程式碼邏輯**：在抽出的長串文字中，尋找夾在 `地址` 和 `權利範圍` 兩個關鍵字中間的那一段字串。

---

## 🚀 快速使用教學

**1. 取得工具**  
請去這個專案的 GitHub 頁面 (`poiucoo/Community-Scraper`) 點擊綠色的 **Code** 按鈕下載 ZIP 檔案，然後解壓縮到電腦裡。

**2. 準備環境**  
確認電腦上已經安裝了 Python 3 後，打開終端機 (命令提示字元)，進入解壓縮的資料夾。

**3. 安裝一句話的套件**  
在終端機輸入以下指令完成依賴安裝：
```bash
pip install pymupdf pandas requests
```

**4. 蒐集連結**  
像我們之前示範的一樣，把要蒐集的社區的每個「下拉地址、所有人名稱與 PDF 網址」複製下來，依照教學貼到一個 `社區名稱_data.json` 檔案中。

**5. 啟動神速下載**  
在終端機輸入：
```bash
python download_and_ocr.py 該社區名稱
```

**Boom! 💥 只要幾秒鐘，多執行緒就會平行瘋狂下載 PDF 解析出純文字門牌，再吐回一份乾淨的 `.csv` Excel 表格了！**